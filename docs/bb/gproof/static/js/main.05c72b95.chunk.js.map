{"version":3,"sources":["Util.js","Terminal.js","Term.js","OrdDBI.js","Cytoscape.js","App.js","registerServiceWorker.js","index.js"],"names":["Cmd","f","Object","classCallCheck","this","cmd","dmap","d","fromEntries","entries","map","Unique","name","createClass","key","value","allIndexed","R","find","arr","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","x","y","err","return","blue","concat","green","orchid","window","$","log","console","greetings","help","bio","website","open","focus","video","layout","basic","hui","about","info","n","data","_a","_b","_c","_d","_2","_3","toString","s","isNaN","String","Array","isArray","length","slice","join","id","e","trshelp","trsabout","trsdemo","terminal","exec","trsdemo2","execs","cmds","delay","arguments","i","setTimeout","Terminal","props","_this","possibleConstructorReturn","getPrototypeOf","call","state","command","setState","_this2","_this$props","interpreter","options","objectWithoutProperties","onCommandChange","update","term","result","eval","echo","error","node","destroy","_this3","react_default","a","createElement","ref","React","Component","COLORS","black","gray","gold","red","make_str","con","_len","args","_key","make_uni","_len2","_key2","apply","toConsumableArray","hash0","Term","_len3","_key3","save","flash","_len4","_key4","construct","constructor","App","_Term","inherits","color","shape","text-margin-y","Judg","Quote","arg","ord","val","objectSpread","get","prototype","edgename","_len5","_key5","Prim","_len6","_key6","Type","type","_len7","_key7","Truth","_this4","_len8","_key8","prim","_len9","_key9","_len10","_key10","quote","_len11","_key11","prop","_len12","_key12","Prop","_len13","_key13","plus","_len14","_key14","mul","_len15","_key15","ifte","_len16","_key16","step","_len17","_key17","steps","_len18","_key18","bstep","_len19","_key19","isa","_len20","_key20","eq","_len21","_key21","norm","_len22","_key22","top","_len23","_key23","_truth","_len24","_key24","_mv","_len25","_key25","MVar","arithRules","WILD","U","_this5","pred","t","_len26","_key26","_this6","border-color","_len27","_key27","Rule","prems","conc","remove","v","v1","v2","t1","t2","t3","B_Value","B_IfTrue","B_IfFalse","B_Plus","B_Mul","RULES","K","E","V","sticky","Builder","cy","_this7","STORE","run","test","_this8","add","uni","hash","edges","forceStyle","getData","batch","ext","extent","position","x1","x2","Math","random","w","y1","y2","h","_ref","_ref2","slicedToArray","edgeData","source","target","width","getEdgeData","push","_this9","force","incomers","outgoers","out","r","_this10","_len28","nodes","_key28","filter","visible","p","b","n2","dx","dy","sqrt","forcey","forcex","shift","fit","setInterval","tick","M","unify","patterns","m","match","pattern","every","_ref3","_ref4","_len29","terms","_key29","_ref5","_ref6","t0","union","_ref7","_ref8","_ref9","l0","_ref10","l1","xhash","p0","p1","_ref11","_p","_p2","ps","u","_ref12","_ref13","maketruth","label","replace","copy","_ref14","_ref15","ureplace","_p3","_p4","l","mv","rule","_len30","_key30","goal","_this11","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","truths","g","prove","use","thiz","stack","frame","_thiz$iprove$","iprove","rules","truth","pop","_stack$pop","_ref16","subgoals","_rules$","_this12","aprove","str","_this13","_len31","_key31","goals","all","values","allprems","includes","toRemove","rem","allToAdd","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_loop","toAdd","proved","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_loop3","_step6","used","rprems","rp","_U$find","_U$find2","M2","_U$find3","_U$find4","ret","_loop2","_iterator6","_ref20","_iterator3","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","_ref19","_ref18","tn","c","Flavor","freeze","CUT","DIFF","CHOP","Ind","flavor","ORD","icut","idiff","ichop","zero","Shift","ind","T","Var","myRules","S_Refl","E_S","E_B","merge","j","t5","B","cytoscape","klay","animate","direction","dagre","nodeSep","rankSep","none","tree","cose","cxtmenu","style","selector","content","text-valign","background-color","ele","border-width","text-outline-color","text-outline-width","font-size","text-wrap","curve-style","target-arrow-shape","line-color","target-arrow-color","source-endpoint","Cytoscape","send","focusTerm","setupCyto","bind","assertThisInitialized","cyto","G","$id","maxZoom","toLayout","lay","positions","nonempty","scratch","sort","e1","e2","parseInt","empty","children","_children$","cnode","cshape","max","L","S","newShape","roots","place","pos","treeLayout","elements","dists","bellmanFord","root","colors","distanceTo","focused","collapsed","underAllFocused","acc","intersection","successors","blockedEdges","isEdge","show","isNode","hide","not","breadthFirstSearch","directed","visit","has","maybeLay","setLay","batching","startBatch","endBatch","NEXT_ID","from","spl","edge","mid","dia","applyN","opacity","duration","grow","stop","min","unfocus","toggleShow","toggleFocus","collapse","expand","reset","clear","trs","userZoomingEnabled","userPanningEnabled","document","getElementById","display","ireduce","reduce","areduce","iequate","isteps","on","evt","originalEvent","altKey","shiftKey","ctrlKey","metaKey","commands","select","fillColor","build","containerID","cyRef","cytoscapeOptions","wheelSensitivity","setupTerm","insert","mecho","debug","mlog","dbg","searchParams","URLSearchParams","location","search","className","Row","Col","xs","sm","md","lg","background","onClick","lib_default","transform","src_Cytoscape","src_Terminal_0","onInit","prompt","secret","isLocalhost","Boolean","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","catch","ReactDOM","render","src_App_0","URL","process","origin","addEventListener","fetch","response","status","headers","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.05c72b95.chunk.js","sourcesContent":["\nimport * as R from 'ramda';\n\nexport class Cmd { constructor(f) { this.f = f; } }\nexport function cmd(f) { return new Cmd(f); }\n// window.hi = cmd(() => {window.echo(\"hello\")});\nexport function dmap(d, f) { return Object.fromEntries(Object.entries(d).map(f)); }\n// window.dmap = dmap;\n\nexport class Unique {\n    constructor(name) { this.name = name; }\n    toString() { return this.name; }\n}\n\nexport const allIndexed = R.addIndex(R.all);\n\nexport function find(arr, f) {\n    for (var x of arr) {\n        let y = f(x);\n        if (y) { return [x, y]; }\n    }\n    return [null, null];\n}\n\n// export default cmd;\n// export default Cmd;\n// export {cmd, Cmd};","import React from 'react';\nimport 'jquery.terminal';\nimport 'jquery.terminal/css/jquery.terminal.css';\nimport {cmd, Cmd} from './Util.js';\nimport './Terminal.css';\nimport $ from 'jquery';\nimport * as R from 'ramda';\n\nwindow.R = R;\nwindow.$ = $;\nwindow.log = console.log;\n\nwindow.greetings = `[[;royalblue;]--- Alexander Varga ---]\n\nThis is what I call a [[;limegreen;]Hybrid UI] (HUI).\n- All actions take place through this terminal on the right.\n- The GUI on the left can send commands to the terminal.\n\nCommands can be run automatically from the GUI:\n- [[;gold;]click]        a node to send its id to the terminal.\n- [[;gold;]RIGHT-click]  a node for additional commands.\n\nCommands can be entered manually:\n- Type [[;mediumorchid;]111*111] and press enter to do math.\n- Try entering [[;mediumorchid;]flash(G(8))] by a combination of typing and clicking nodes.\n\nType [[;limegreen;]help] and press enter for help and general commands.\nType [[;limegreen;]trshelp] and press enter for help with the term rewriting system.\nType [[;limegreen;]video] and press enter to see a video demo.\n`;\nwindow.help = `\n=> bio      : my bio\n=> website  : open my website in new tab\n=> layout   : information about layouts\n=> basic    : basic use of this Hybrid UI\n=> hui      : information about Hybrid UIs in general\n=> about    : how this was made\n`\n// => trs      : start the term rewrite system\n\n// - [[;gold;]CTRL-click]  a node to toggle hidden: [[;gold;]◆]\n// - [[;gold;]SHIFT-click] a node to toggle focused: [[;gold;]★]\n// - Type [[;mediumorchid;]reset] and press enter to reset.\n// - Type [[;mediumorchid;]setLay(dagre)] or [[;mediumorchid;]setLay(cose)] for different layouts.\n\n\nwindow.bio = `\nI am a mathematically-minded software developer who is fascinated by programming\nlanguages and abstractions that enable coherent, maintainable, and verifiably-\ncorrect software.\n`\n\nwindow.website = cmd(function() {\n  var win = window.open(\"https://www.asvarga.com\", '_blank');\n  win.focus();\n})\n\nwindow.video = cmd(function() {\n  var win = window.open(\"https://vimeo.com/355226173\", '_blank');\n  win.focus();\n})\n\nwindow.layout = `\n=> lay() : redo layout\n=> reset() : expand all and layout\n=> setLay(_) : try a differenet layout\n  - examples: dagre, cose, klay\n`\nwindow.basic = `\nThis console runs ordinary Javascript.\nClick on something on the left to send an identifier like 'G(_)' to the console.\nUse a combination of clicking and typing to try the following:\n\n- Basic JS:\n  => x = 2+2\n  => x*x\n- Graph stuff:\n  => G(_).target()\n  => flash(G(_))\n- Add an node/edge/both:\n  => add()\n  => add(G(_), G(_))\n  => add(G(_), add())\n- Remove nodes/edges:\n  => rem(G(_), ...)\n- Split an edge:\n  => spl(G(_))\n`;\nwindow.hui = `\nHybrid UIs enable rapid experimentation without the hastle of interface design.\nI originally made this to experiment with Term Rewriting Systems.\n\nHowever, they have the additional benefit of allowing reproducible interactions.\nReproducing/automating GUI actions can be difficult.\nWhen everything is serialized through the terminal, it's easier.\n`;\nwindow.about = `\nThis demo was built using:\n- React\n- react-cytoscape\n- jquery.terminal\n`;\n\nwindow.info = n => n.data(\"info\");\n\n////\n\n// window.trshelp = `\n\n// `;\n\nfunction gold(x) { return `[[;gold;]${x}]`; }\nfunction blue(x) { return `[[;royalblue;]${x}]`; }\nfunction green(x) { return `[[;limegreen;]${x}]`; }\nfunction orchid(x) { return `[[;mediumorchid;]${x}]`; }\nlet _a = blue('a');\nlet _b = green('b');\nlet _c = orchid('c');\nlet _d = orchid('d');\nlet _2 = blue('2');\nlet _3 = green('3');\nwindow.trshelp = `\nTerm Rewriting Systems mechanize reasoning like:\n(${_a}*${_b})+(${_a}*${_c}) is simply ${_a}*(${_b}+${_c}) so (${_2}*${_3})+(${_2}*${_d}) is simply ${_2}*(${_3}+${_d})\n\nHere, I'm using one to implement a Proof Assistant.\n☆ : Hollow stars represent goals we wish to prove.\n★ : Filled stars represent theorems we have proved.\n\nTry these:\n=> trsdemo   : run a demo\n=> trsdemo2  : run a longer demo\n=> trsabout  : about term rewrite systems\n\nMethods:\n- reduce(t) : create a goal to reduce term t\n- prove(g)  : automatically prove goal g\n- ireduce/iprove : interactive reducion/proving\n- areduce/aprove : animated reduction/proving\n`;\nwindow.trsabout = cmd(function() {\n  var win = window.open(\"https://en.wikipedia.org/wiki/Rewriting#Term_rewriting_systems\", '_blank');\n  win.focus();\n})\n\nwindow.trsdemo  = cmd(() => {window.terminal.exec(`areduce(G(161))`)});\nwindow.trsdemo2 = cmd(() => {window.terminal.exec(`areduce(G(164))`)});\n\n// window.trsdemoq = cmd(() => window.send(`\n// ireduce(G(161));\n// iprove(G(172));\n// iprove(G(184));\n// iprove(G(178));\n// iprove(G(172));`));\n\n// window.trsdemo = cmd(() => window.execs([\n//   \"ireduce(G(161))\",\n//   \"iprove(G(172))\",\n//   \"iprove(G(184))\",\n//   \"iprove(G(178))\",\n//   \"iprove(G(172))\"  // , \"toggleFocus(G(200))\"\n// ]));\nwindow.execs = function(cmds, delay=1000) {\n  let i = 0;\n  function f() {\n    if (i < cmds.length) { window.terminal.exec(cmds[i]); i++; }\n    window.setTimeout(f, delay);\n  }\n  f();\n}\n\n// window.trsdemo2 = cmd(() => window.execs([\n//   \"sticky /= 10\",\n//   \"ireduce(G(164))\",\n//   \"iprove(G(172))\",\n//   \"r(G(179))\",\n//   \"r(G(185))\",\n//   \"iprove(G(190))\",\n//   \"r(G(211))\",\n//   \"iprove(G(201))\",\n//   \"iprove(G(206))\",\n//   \"iprove(G(190))\",\n//   \"iprove(G(196))\",\n//   \"iprove(G(223))\",\n//   \"iprove(G(229))\",\n//   \"iprove(G(196))\",\n//   \"iprove(G(172))\"\n// ]));\n\n////\n\nfunction toString(x) {\n  if (typeof x === 'string') {\n    // return x;\n    return `[[;gold;]\"${ x }\"]`;\n  } else if (x instanceof Cmd) {\n    var s = x.f();\n    if (s) { return `[[;gold;]\"${ s }\"]` }\n  } else if (!isNaN(x)) {\n    return `[[;mediumorchid;]${ String(x) }]`;\n  } else if (Array.isArray(x)) {\n    if (x.length > 10) {\n      return \"[[;limegreen;]⁅]\" + x.slice(0, 10).map(toString).join(\"[[;limegreen;], ]\") + \"[[;limegreen;], ]...[[;limegreen;]⁆]\"\n    } else {\n      return \"[[;limegreen;]⁅]\" + x.map(toString).join(\"[[;limegreen;], ]\") + \"[[;limegreen;]⁆]\";\n    }\n  } else if (typeof x === 'object') {\n    try {\n      // return String(R.map(n => n.id(), x));\n      if (x.id()) {\n        return `[[;orange;]{]G(${ x.id() })[[;orange;]}]`;\n      } else {\n        return \"[[;orange;]{]...[[;orange;]}]\";\n      }\n    } catch (e) {\n      return \"[[;orange;]{]...[[;orange;]}]\";\n    }\n  } else if (typeof x === \"function\") {\n    return `[[;royalblue;](${ x.name })]`;\n  } else {\n    return String(x);\n  }\n}\n\nclass Terminal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {command: ''};\n  }\n  update(command) {\n    this.setState({\n      command\n    });\n  }\n  componentDidMount() {\n    var {interpreter, ...options} = this.props;\n    if (!options.onCommandChange) {\n      options.onCommandChange = (command) => this.update(command);\n    }\n    interpreter = interpreter || function(command, term) {\n      if (command !== '') {\n        try {\n          var result = window.eval(command);\n          if (result !== undefined) {\n            var s = toString(result);\n            if (s !== undefined) { term.echo(s); }\n          }\n        } catch(e) {\n          term.error(String(e));\n          // throw(e);\n        }\n      } else {\n        term.echo('');\n      }\n    };\n    this.terminal = $(this.node).terminal(interpreter, options);\n  }\n  componentWillUnmount() {\n    this.terminal.destroy();\n  }\n  isCommandControlled() {\n    return this.props.command !== undefined;\n  }\n  render() {\n    return (\n      <div ref={(node) => this.node = node}></div>\n    );\n  }\n}\n\nexport default Terminal;\n","\n// import React from 'react';\n// import Cytoscape from './Cytoscape.js';\n\nimport * as U from './Util.js';\nimport * as R from 'ramda';\n\n////\n\nexport const COLORS = {\n  blue:   \"#11479E\", \n  black:  \"#0A1128\", \n  gray:   \"#586F7C\", \n  gold:   \"#EAC435\", \n  red:    \"#E40066\"\n};\n\nexport function make_str(con, ...args) { return \"(\"+con+\" \"+args.map(String).join(\" \")+\")\"; }\nexport function make_uni(con, ...args) { return make_str(con, ...args.map(a => a.hash0())); }\n\n//// TERMS ////\n\nexport class Term {\n  // constructor does just enough to compute uni and save args\n  constructor(con, ...args) {\n    this.con = con;\n    this.args = args;\n    this.save = false; \n  }\n\n  hash0() { return `@${this.id}`; }\n  hash() { return make_uni(this.con, ...this.args); }\n  getData() { return {}; }\n  getEdgeData(i) { return {}; }\n\n  toString() { return make_str(this.con, ...this.args); }\n  // toString() { return this.hash(); }\n  // fullString() { return make_str(this.con, ...this.args); }\n  flash() { window.flash(this.node); }\n  copy(...args) { return new this.constructor(this.con, ...args); }\n}\n\nexport class App extends Term {\n  getData() { return {color: COLORS.blue, shape: \"triangle\", 'text-margin-y': '5px'}; }\n}\n\nclass Judg extends Term {\n  getData() { return {color: COLORS.gray, shape: \"diamond\"}; }\n}\n\nclass Quote extends Judg {\n  constructor(arg, ord=1) {\n    super(\"quote\", arg);\n    this.ord = ord;\n    this.val = arg;\n  }\n  getData() { return {name: `+${this.ord}+`, ...super.getData()}; }\n  getEdgeData(i) { return {edgename: null}; }\n  copy(...args) { return new this.constructor(...args); }\n}\n\nclass Prim extends Term {\n  constructor(val, f=null) { \n    super(\"prim\");\n    this.val = val;\n    this.f = f;\n  }\n  // hash0() { return this.val; }\n  hash() { return this.val; } // Math.random(); }\n  toString() { return String(this.val); }\n  getData() { return {name: this.val, color: COLORS.black}; }\n  copy(...args) { return new this.constructor(...args); }\n}\n\nclass Type extends Term {\n  constructor(type) { \n    super(\"type\");\n    this.val = type;\n  }\n  hash() { return this.val; }\n  toString() { return this.val; }\n  getData() { return {name: this.val, color: COLORS.red}; }\n  copy(...args) { return new this.constructor(...args); }\n}\n\nclass Truth extends Term {\n  constructor(arg) { \n    super(\"truth\", arg);\n    this.val = arg;\n  }\n  getData() { return {name: \"\", color: COLORS.gold, shape: \"star\", 'text-margin-y': '2px'}; }\n  getEdgeData(i) { return {edgename: null}; }\n  toString() { return `$${this.val}`}\n  copy(...args) { return new this.constructor(...args); }\n}\n\nexport function prim(...args)   { return new Prim(...args ); }\nexport function type(...args)   { return new Type(...args ); }\nexport function quote(...args)  { return new Quote(...args); }\nexport function prop(...args)   { return new Prop(...args); }\n\nexport function term(...args)   { return new App(...args ); }\nexport function plus(...args)   { return new App(\"+\", ...args ); }\nexport function mul(...args)    { return new App(\"x\", ...args ); }\nexport function ifte(...args)   { return new App(\"?:\", ...args ); }\n\nexport function step(...args)   { return new Judg(\"→\", ...args ); }\nexport function steps(...args)  { return new Judg(\"→*\", ...args ); }\nexport function bstep(...args)  { return new Judg(\"⇓\", ...args ); }\nexport function isa(...args)    { return new Judg(\":\", ...args ); }\nexport function eq(...args)     { return new Judg(\"=\", ...args ); }\nexport function norm(...args)   { return new Judg(\"↓\", ...args ); }\nexport function top(...args)    { return new Judg(\"⊤\", ...args ); }\n\n// \"private\"\nexport function _truth(...args) { return new Truth(...args); }\nexport function _mv(...args)    { return new MVar(...args); }\n\nexport const WILD = new U.Unique(\"WILD\");\n\n//// PATTERNS ////\n\nclass MVar extends Term {\n  constructor(name, arg=null, pred=null) {\n    super(\"MV\");\n    switch (typeof pred) {\n      case \"string\":\n        this.pred = (t => t.con === pred); break;\n      case \"function\":\n        this.pred = pred; break;\n      default:\n        this.pred = (()=>true);\n    }\n    this.name = name;\n    this.val = arg;\n  }\n  hash() { return this.arg ? make_uni(\"@\"+this.name, this.arg) : \"@\"+this.name; }   // should use pred too\n  getData() { return {name: this.name, color: COLORS.gray, shape: \"vee\"}; }\n  toString() { return `@${this.name}`; }\n  copy(...args) { return new this.constructor(...args); }\n}\nclass Prop extends Term {\n  constructor(arg) { \n    super(\"prop\", arg);\n    this.val = arg;\n  }\n  getData() { return {\n    name: \"\", shape: \"star\", 'text-margin-y': '2px',\n    color: COLORS.black, 'border-color': COLORS.gold }; }\n  getEdgeData(i) { return {edgename: null}; }\n  toString() { return `?${this.val}`}\n  copy(...args) { return new this.constructor(...args); }\n}\n\nexport class Rule {\n  constructor(name, prems, conc, remove=null) {\n    this.name = name;\n    this.prems = prems;\n    this.conc = conc;\n    this.remove = remove || [];\n  }\n}\n\nexport var arithRules;\nif (true) {\n  // const e_iftrue = window.e_iftrue = new Rule(\"e_iftrue\",\n  //   [ ifte(prim(true), _mv(\"then\"), _mv(\"else\")) ], \n  //   prop(steps(_mv(\"arg0\"), _mv(\"then\"))));\n  // const e_iffalse = window.e_iffalse = new Rule(\"e_iffalse\",\n  //   [ ifte(prim(false), _mv(\"then\"), _mv(\"else\")) ], \n  //   prop(steps(_mv(\"arg0\"), _mv(\"else\"))));\n  // const e_if = window.e_if = new Rule(\"e_if\",\n  //   [ prop(steps(_mv(\"a\"), _mv(\"a'\"))),\n  //     ifte(_mv(\"a\"), _mv(\"then\"), _mv(\"else\"))    ],\n  //   prop(steps(\n  //     ifte(_mv(\"a\"), _mv(\"then\"), _mv(\"else\")),\n  //     ifte(_mv(\"a'\"), _mv(\"then\"), _mv(\"else\")))),\n  //   [ _mv(\"arg0\") ]);\n  // const i_steps = window.i_steps = new Rule(\"i_steps\",\n  //   [ prop(steps(_mv(\"a\"), _mv(\"b\"))),\n  //     prop(steps(_mv(\"b\"), _mv(\"c\")))    ],\n  //   prop(steps(_mv(\"a\"), _mv(\"c\"))),\n  //   [ _mv(\"arg0\"), _mv(\"arg1\") ] );\n  // const e_plus = window.e_plus = new Rule(\"e_plus\",\n  //   [ plus(_mv(\"x\"), _mv(\"y\", prim(WILD))) ],\n  //   prop(steps(_mv(\"arg0\"), M => prim(M.x+M.y))));\n  // const e_mul = window.e_mul = new Rule(\"e_mul\",\n  //   [ mul(_mv(\"x\"), _mv(\"y\", prim(WILD))) ],\n  //   prop(steps(_mv(\"arg0\"), M => prim(M.x*M.y))));\n  // const primisnorm = window.primisnorm = new Rule(\"primisnorm\",\n  //   // [ prop(steps(_mv(\"a\"), _mv(\"a'\", null, (a => !isNaN(a.val))))) ],\n  //   [ prop(steps(_mv(\"a\"), _mv(\"a'\", prim(WILD)))) ],\n  //   prop(bstep(_mv(\"a\"), _mv(\"a'\"))),\n  //   [ _mv(\"arg0\") ] );\n\n  // arithRules = [e_iftrue, e_iffalse, e_if, i_steps, e_plus, e_mul, primisnorm];\n}\nif (true) {\n  let v  = _mv(\"v\" , prim(WILD));\n  let v1 = _mv(\"v1\", prim(WILD));\n  let v2 = _mv(\"v2\", prim(WILD));\n  let t1 = _mv(\"t1\");\n  let t2 = _mv(\"t2\");\n  let t3 = _mv(\"t3\");\n\n  const B_Value = window.B_Value = new Rule(\"B_Value\",\n    [  ], \n    prop(bstep( v , v )));\n  const B_IfTrue = window.B_IfTrue = new Rule(\"B_IfTrue\",\n    [ prop(bstep(t1, prim(true))), prop(bstep(t2, v)) ], \n    prop(bstep( ifte(t1, t2, t3) , v )));\n  const B_IfFalse = window.B_IfFalse = new Rule(\"B_IfFalse\",\n    [ prop(bstep(t1, prim(false))), prop(bstep(t3, v)) ], \n    prop(bstep( ifte(t1, t2, t3) , v )));\n  const B_Plus = window.B_Plus = new Rule(\"B_Plus\",\n    [ prop(bstep(t1, v1)), prop(bstep(t2, v2)) ], \n    prop(bstep( plus(t1, t2) , prim(WILD, a => a(v1) + a(v2))  )));  // a does lookup in mapping\n  const B_Mul = window.B_Mul = new Rule(\"B_Mul\",\n    [ prop(bstep(t1, v1)), prop(bstep(t2, v2)) ], \n    prop(bstep( mul(t1, t2) , prim(WILD, a => a(v1) * a(v2))  )));   // a does lookup in mapping\n\n  arithRules = [B_Value, B_IfTrue, B_IfFalse, B_Plus, B_Mul];\n}\nwindow.RULES = arithRules;\n  \n//// BUILDER ////\n\nwindow.K = \"K\";\nwindow.E = \"E\";\nwindow.V = \"V\";\nwindow.sticky = 0.4;\n\nexport class Builder {\n  constructor(cy, next) {\n    this.cy = cy;\n    this.next = next;\n    this.STORE = {};\n    this.run();\n\n    window.test = U.cmd(() => this.test());\n    // window.send('test');\n  }\n  add(term, save=true) {\n    if (!term) { return; }\n    term.save |= save;\n\n    // make children\n    term.args = term.args.map(arg => this.add(arg, false));\n\n    // cons hashing\n    var uni = term.hash();\n    if (uni in this.STORE) { \n      term = this.STORE[uni];\n      term.save |= save; \n      this.cy.add(term.node);\n      term.edges.map(e => this.cy.add(e));\n      return term;\n    }\n    this.STORE[uni] = term;\n\n    // build term\n    term.id = this.next();\n    var data = {\n      term,\n      id: term.id, name: term.con,\n      forceStyle: true,\n      ...term.getData()\n    }\n    \n    window.batch();\n    // term.node = this.cy.add({data});\n    let ext = this.cy.extent();\n    term.node = this.cy.add({data, position: {\n      x:(ext.x1+ext.x2)/2+Math.random()*ext.w/10, // y:ext.y2-ext.h/10}});\n      y:(ext.y1+ext.y2)/2+Math.random()*ext.h/10}});\n\n    // connect children\n    term.edges = [];\n    for (var [i, arg] of term.args.entries()) {\n      // console.log(arg);\n      var edgeData = {\n        id: this.next(), edgename: i,\n        source: term.node.id(), \n        target: arg.node.id(),\n        width: 2,\n        ...term.getEdgeData(i)\n      }\n      term.edges.push(this.cy.add({data: edgeData}));\n    }\n\n    return term;\n  }\n  r(node, force=true) {\n    node = n(node);\n    if (!node) { return; }\n    var term = t(node);\n    if (force) { term.save = false; }\n    if (!term.save && node.incomers('node').length == 0) {\n      var outgoers = node.outgoers('node');     // store outgoers but don't recur yet\n      this.cy.remove(node);                     // remove node\n      outgoers.map(out => this.r(out, false));  // okay now recur\n    }\n  }\n  rs(...nodes) { nodes.map(n => this.r(n)); }\n  tick() { \n    const mul = 1;\n    var nodes = this.cy.nodes().filter(n => n.visible());\n    var edges = this.cy.edges().filter(n => n.visible());\n    let ext = this.cy.extent();\n    let cx = (ext.x1+ext.x2)/2;\n    let cy = (ext.y1+ext.y2)/2;\n    nodes.map(n => {\n      n.d = {x:0, y:0};\n      n.p = n.position();\n    });\n    nodes.map(n => {\n      var args = t(n).args;\n      for (var i=0; i<args.length-1; i++) {\n        var a = args[i].node[0];\n        var b = args[i+1].node[0];\n        let dx = b.p.x - a.p.x;\n        // push first sibling 80 left of next\n        let force = (dx - 80)/(10+0*i);\n        a.d.x += force*mul;\n        b.d.x -= force*mul;\n      }\n      nodes.map(n2 => {\n        if (n == n2) { return; }\n        let dx = n2.p.x - n.p.x;\n        let dy = n2.p.y - n.p.y;\n        let d = Math.sqrt(dx*dx + dy*dy);\n        // but push close nodes apart // pull pairs of nodes together\n        let force = (d<80 ? (80-d)/20 : 0);// - d/2000;\n        n.d.x -= dx/d*force*mul;\n        n.d.y -= dy/d*force*mul;\n        n2.d.x += dx/d*force*mul;\n        n2.d.y += dy/d*force*mul;\n      });\n      // // push roots to y=0\n      // if (!n.incomers().length) {\n      //   let force = n.p.y/10;\n      //   n.d.y -= force*mul;\n      // }\n    });\n    edges.map(e => {\n      var s = e.source();\n      var t = e.target();\n      let dy = t.p.y - s.p.y;\n      let dx = t.p.x - s.p.x;\n      // push target 80 below source\n      let forcey = (dy - 80)/10;\n      s.d.y += forcey*mul;\n      t.d.y -= forcey*mul;\n      // pull connected nodes together \n      let forcex = dx/80;\n      s.d.x += forcex*mul;\n      t.d.x -= forcex*mul;\n    })\n    nodes.map(n => {\n      if (n.d.x*n.d.x + n.d.y*n.d.y > window.sticky) {\n        n.shift(n.d);\n      }\n    });\n    this.cy.fit(nodes, 20);\n  }\n  run() { \n    setInterval(this.tick, 50);\n  }\n  test() {\n    let a =   this.add(prop(plus(_mv('x'), plus(prim(13), prim(14)))));\n    let b =   this.add(_truth(plus(plus(prim(11), prim(12)), _mv('y'))));\n    let M =   this.unify(a, b);\n    // // let res = this.add(this.replace(a, M));\n    console.log(String(a));\n    console.log(String(b));\n    console.log(M);\n\n    // let x = plus(prim(10), prim(20));\n    // this.add(x);\n    // this.r(x);\n    // return this.add(x);\n  }\n\n  //// REWRITING ////\n\n  match(patterns, ...terms) {\n    var M = {\"m\":1};\n    function match(pattern, term) {\n      // console.log(String(pattern), String(term));\n      if (pattern === term) { return true; }\n      switch (pattern.con) {\n        case \"MV\":\n          if (pattern.name in M) { return M[pattern.name] == term; }\n          M[pattern.name] = term;\n          if (!pattern.pred(term)) { return false; }\n          if (pattern.val) { return match(pattern.val, term); }\n          return true;\n        case \"prim\":\n        case \"type\":\n          return term.con == pattern.con && (term.val == pattern.val || pattern.val == WILD);\n        case \"prop\":\n          return (term.con == \"truth\" || term.con == \"prop\") && match(pattern.val, term.val);\n        default:\n          if (pattern.con !== term.con) { return false; }\n          if (pattern.args.length !== term.args.length) { return false; }\n          return Object.entries(pattern.args).every(([i,a]) => match(a, term.args[i]));\n      }\n    }\n    if (!Array.isArray(patterns)) { patterns = [patterns] }\n    if (patterns.length != terms.length) { return false; }\n    if (U.allIndexed( ([p,t],i) => match(_mv(\"arg\"+i, p), t), R.zip(patterns, terms) )) { return M; }\n  }\n  unify(t0, t1, M=null) {\n    let next = this.next;\n    // {[term,(0|1|2)] : term}\n    if (M) {\n      M = U.dmap(M, R.identity);\n    } else {\n      M = {\"u\":1};\n    }\n    function union([t0,l0], [t1,l1]) {\n      M[[t0.hash(),l0]] = [t1,l1];\n      return [t1,l1];\n    }\n    function find(x) {\n      if (x in M) {\n        let xhash = [x[0].hash(),x[1]];\n        M[xhash] = find(M[xhash]);\n        return M[xhash];\n      }\n      return x;\n    }\n    function val(p) { return [p[0].val, p[1]]; }\n    function args(p) { return R.map(a => [a,p[1]], p[0].args); }\n    function unify(p0, p1) {\n      [p0, p1] = [find(p0), find(p1)];  // get roots of union trees\n      if (p0 === p1) { return true; }   // if same then done early\n      let [[t0,l0],[t1,l1]] = [p0,p1];  // extract terms and labels\n      if (t0 === null || t1 === null) { return true; }  // happens if val of MV is null\n\n      if (t0.con == t1.con) {\n        let con = t0.con;\n        if (con == \"MV\") { union(p0, union(p1, [_mv(`~${next()}~`), 2])); return unify(val(p0), val(p1)); }\n        if (con == \"prim\" || con == \"type\") { \n          return (t0.val == WILD) || (t1.val == WILD) || (t0.val == t1.val);\n          // if (t0.val == WILD) { union(p0, p1); return true; }\n          // if (t1.val == WILD) { union(p1, p0); return true; }\n          // return t0.val == t1.val; \n        }\n        return R.all( ps => unify(...ps) , R.zip(args(p0), args(p1)) );\n      } else {\n\n        if (t0.con == \"MV\") { union(p0, p1); return unify(val(p0), p1); }\n        if (t1.con == \"MV\") { union(p1, p0); return unify(val(p1), p0); }\n        if (t0.con == \"prop\" && t1.con == \"truth\") {\n          union(p0, p1);\n          return R.all( ps => unify(...ps) , R.zip(args(p0), args(p1)) ); \n        }\n        if (t1.con == \"prop\" && t0.con == \"truth\") {\n          union(p1, p0);\n          return R.all( ps => unify(...ps) , R.zip(args(p0), args(p1)) ); \n        }\n      }\n    }\n  \n    if (!Array.isArray(t0)) { t0 = [t0] }\n    if (!Array.isArray(t1)) { t1 = [t1] }\n    if (t0.length != t1.length) { return false; }\n    // if (U.allIndexed( ([t,s],i) => unify([_mv(\"arg\"+i, t),0], [_mv(\"arg\"+i, s),1]), R.zip(t0, t1) )) { return M; }\n    if (R.all( ([t,s]) => unify([t,0], [s,1]), R.zip(t0, t1) )) { return M; }\n  }\n\n  replace(t, M, maketruth=false, label=0) {\n    function find(x) {  // THIS IS COPY/PASTED FROM UNIFY :(\n      if (x in M) {\n        let xhash = [x[0].hash(),x[1]];\n        M[xhash] = find(M[xhash]);\n        return M[xhash];\n      }\n      return x;\n    }\n    function args(p) { return R.map(a => [a,p[1]], p[0].args); }\n    function ureplace(p) {\n      p = find(p);\n      let [t,l] = p;\n      switch (t.con) { \n        case \"MV\":    // already did find so p is root and still free in result\n        case \"type\":  return t;\n        case \"prim\":\n          if (t.f) {  \n            let val = t.f(mv => M[[mv,l]][0].val);      // pass lookup function\n            if (val instanceof Term) { return val; }\n            return prim(val); \n          }  \n          return t;\n        case \"prop\":  return (maketruth ? _truth : prop)(...args(p).map(ureplace));\n        default:      return t.copy(...args(p).map(ureplace));\n      }\n    }\n    function replace(conc) {\n      switch (conc.con) { \n        case \"MV\":    return M[conc.name];\n        case \"prim\":\n          if (conc.f) { return conc.copy(conc.f( U.dmap(M, ([k,v]) => [k,v.val]) )); }\n          return conc;\n        case \"type\":  return conc;\n        case \"prop\":  return (maketruth ? _truth : prop)(replace(conc.val));\n        default:      return new conc.constructor(conc.con, ...conc.args.map(replace));\n      }\n    }\n    if (!M)  { return; }\n    if (M.u) { \n      // if (t instanceof Rule) { \n      //   return new Rule(t.name+\"'\", t.prems.map(p => ureplace([p,label])), ureplace([conc,label]), t.remove);\n      // }\n      return ureplace([t,label]); }\n    if (M.m) { \n      // if (t instanceof Rule) { \n      //   return new Rule(t.name+\"'\", t.prems.map(p => ureplace([p,label])), ureplace([conc,label]), t.remove);\n      // }\n      return replace(t); \n    }\n  }\n\n  use(rule, ...prems) {\n    prems = prems.map(t);\n    if (prems.length == rule.prems.length) {            // desired conc *not* provided\n      let M = this.match(rule.prems, ...prems);\n      if (M) { return this.replace(rule.conc, M, true); }\n    } else if (prems.length == rule.prems.length+1) {   // desired conc *is* provided\n      let M = this.unify([rule.conc].concat(rule.prems), prems);\n      if (M) { return this.replace(rule.conc, M, true); }\n    }\n  }\n\n  prove(goal) {\n    for (var rule of window.RULES) {\n      var M = this.unify(rule.conc, goal);\n      if (M) {  // this rule can build the goal\n        var subgoals = rule.prems.map(p => this.replace(p, M));\n        var truths = subgoals.map(g => this.prove(g));\n        if (truths.every(R.identity)) {\n          return this.use(rule, goal, ...truths);\n        }\n      }\n    }\n  }\n  reduce(node) {\n    return this.add(this.prove(prop(bstep(t(node), _mv('res')))));\n  }\n\n  aprove(goal, delay=1000) {\n    let thiz = this;\n    let stack = [];\n    function push(goal) {\n      let frame = {goal};\n      let {rules, truth} = thiz.iprove(\"V\", goal)[0];   // break out subgoals\n      frame.rules = rules.map(rule => ({truths: [], ...rule}));\n      frame.truth = truth;\n      stack.push(frame);\n    }\n    function pop() {\n      var {rules, truth} = stack.pop();\n      rules.map(({subgoals}) => subgoals.map(s => thiz.r(thiz.add(s))));\n      if (stack.length) {\n        let {rules} = stack[stack.length-1];\n        if (truth) {  // success\n          rules[0].truths.push(truth); \n        } else {      // fail\n          let {subgoals} = rules.shift();\n          subgoals.map(s => thiz.r(s));\n        }\n      }\n    }\n    function step() {\n      while(stack.length) {\n        // console.log(stack);\n        let frame = stack[stack.length-1];\n        let {goal, rules, truth} = frame;\n        if (!rules.length || truth) { // pop\n          pop();\n        } else {\n          let {rule, subgoals, truths} = rules[0];\n          if (subgoals.length == truths.length) {  // all truths found\n            frame.truth = this.iprove(\"V\", rule, goal, ...truths)[0].truth;   // build up truth\n          } else {  // more work to do\n            let subgoal = subgoals[truths.length];\n            push(subgoal);\n            window.setTimeout(step, delay);\n            break;\n          }\n        }\n      }\n    }\n    push(goal);\n    window.setTimeout(step, delay);\n  }\n  areduce(node, delay=1000) {\n    let goal = this.add(prop(bstep(t(node), _mv('res'))));\n    window.setTimeout(() => this.aprove(goal, delay), delay);\n    window.echo(`[[;gold;]\"Animatedly proving [[;royalblue;]${str(goal)}]\"]`);\n  }\n\n  ireduce(node) {\n    let goal = this.add(prop(bstep(t(node), _mv('res'))));\n    window.echo(`[[;gold;]\"Interactively proving [[;royalblue;]${str(goal)}]\"]`);\n  }\n\n  iprove(...args) { \n    args = args.map(t);\n    let goals = args.filter( x => x instanceof Prop  );\n    let prems = args.filter( x => x instanceof Truth ); // TODO: allow non-truths?\n    let rules = args.filter( x => x instanceof Rule  );\n    // if (!rules.length && goals.length) { rules = window.RULES; }  // default to all rules when goal-directed\n    if (!rules.length) { rules = window.RULES; }  // default to all rules when goal-directed\n\n    let all = Object.values(this.STORE).filter(t => n(t).visible());\n    let allprems = all.filter(t => t instanceof Truth && !(t in prems));\n    let allgoals = all.filter(t => t instanceof Prop  && !(t in goals));\n\n    let K = args.includes(\"K\");\n    let toRemove = [];\n    function rem(t) { if (!K && !toRemove.includes(t)) { toRemove.push(t); } }\n\n    // let E = args.includes(\"E\");\n    function log(x)  { if (false) { console.log(x); } return x; }\n    function echo(x) { if (true) { window.echo(`[[;gold;]\"${x}\"]`); } return x; }\n\n    log(\"--- iprove ---\");  \n\n    let v = args.includes(\"V\");\n    let allToAdd = [];\n\n    for (let goal of goals) {\n      log(`Goal: ${String(goal)}`);\n      let toAdd = [];\n      let proved = false;\n      for (let rule of rules) {\n        log(`Rule: ${rule.name}`);\n      \n        var M = this.unify(rule.conc, goal);\n        if (!M) { continue; }\n\n        let used = [];\n        let rprems = rule.prems.filter(rp => {\n          let [p, M2] = U.find(prems, p => this.unify(rp, p, M));       // prems\n          if (p) { used.push(p); M = M2; }\n          return !p;\n        }).filter(rp => {\n          let [p, M2] = U.find(allprems, p => this.unify(rp, p, M));  // allprems\n          if (p) { used.push(p); M = M2; }\n          return !p;\n        });\n        \n        if (rprems.length) {\n          toAdd.push({rule, subgoals: rprems.map(rp => this.replace(rp, M))});\n        } else {\n          let ret = this.add(this.replace(rule.conc, M, true));\n          echo(`Proved [[;royalblue;]${str(ret)}] with [[;mediumorchid;]${rule.name}]`);\n          rem(goal); \n          used.map(rem);\n          if (v) { allToAdd.push({goal, rules: [], truth: ret}); }\n          proved = true;\n          break; // don't try any more goals, on to next goal\n        }\n      }\n      if (!proved) {\n        toAdd.map(({rule, subgoals}) => {\n          echo(`Added subgoals to prove [[;royalblue;]${String(goal)}] with [[;mediumorchid;]${rule.name}]`);\n          subgoals.map(t => this.add(t));\n        });\n        if (v) { allToAdd.push({goal, rules: toAdd}); }\n      }\n    }\n    if (!goals.length) {\n      log(`No Goal`);\n      for (let rule of rules) {\n        log(`Rule: ${rule.name}`);\n        if (rule.prems.length != prems.length) { continue; }\n        var M;\n        for (let [rp, p] of R.zip(rule.prems, prems)) {\n          M = this.unify(rp, p, M);\n          if (!M) { continue; }\n        };\n        log(String(rule.conc));\n        log(M);\n        let ret = this.add(this.replace(rule.conc, M, true));\n        if (ret) {\n          echo(`Proved [[;royalblue;]${str(ret)}] with [[;mediumorchid;]${rule.name}]`);\n          // prems.map(rem);\n          // allgoals.filter(g => this.match(g, ret)).map(rem);\n        }\n      }\n    }\n    \n    toRemove.map(t => this.r(t));\n    if (v) { return allToAdd; }\n  }\n\n  iequate(node) {\n    let goal = this.add(prop(eq(t(node), _mv('res'))));\n    window.echo(`[[;gold;]\"Interactively proving [[;royalblue;]${str(goal)}]\"]`);\n  }\n\n  isteps(node) {\n    let goal = this.add(prop(steps(t(node), _mv('res'))));\n    window.echo(`[[;gold;]\"Interactively proving [[;royalblue;]${str(goal)}]\"]`);\n  }\n\n}\n\n//// EXPORTS ////\n\n// (term|node -> term)\nfunction t(x) {\n  // if (x instanceof Term) { return x; }\n  if (x.data) { return x.data('term'); }\n  return x\n}\n// (term|node -> node)\nfunction n(x) {\n  if (x instanceof Term) { return x.node; }\n  return x;\n}\n// (term|node -> [term,node])\nfunction tn(x) {\n  return [t(x), n(x)];\n}\nwindow.t = t;\nwindow.n = n;\nwindow.tn = tn;\n\n// var t = window.t = (n => n.data('term'));\nvar c = window.c = (n => t(n).con);\n// var v = window.v = (n => t(n).val);\n// var n = window.n = (n => n.data('name'));\nvar str = window.str = (n => String(t(n)));\nvar u = window.u = (n => t(n).hash());\n\nexport default Builder;\n\n","\nimport * as U from './Util.js';\nimport * as R from 'ramda';\nimport * as T from './Term.js';\n\n////\n\n// Parameterized Term\n// class PTerm extends T.Term {\n//     constructor(param, ...args) {\n//         super(...args);\n//         this.param = param;\n//     }\n//     getEdgeData(i) { return {edgename: this.param}; }\n//     getData() { return {color: T.COLORS.red, shape: \"diamond\"}; }\n// }\n// class Var extends T.Term {\n//     constructor() { super(\"var\"); }\n//     getData() { return {color: T.COLORS.blue, shape: \"vee\", name: null}; }\n// }\n// class App2 extends T.App {\n//     constructor(f, arg) { super(\"()()\", f, arg); }\n//     getData() { return {color: T.COLORS.blue, shape: \"triangle\", name: null}; }\n//     getEdgeData(i) { return {edgename: null}; } // i ? null : 'f'\n// }\n// class Lamb extends T.App {\n//     constructor(arg) { super(\"λ\", arg); }\n//     getData() { return {color: T.COLORS.blue, shape: \"pentagon\", name: null}; }\n//     getEdgeData(i) { return {edgename: null}; }\n// }\n// class Chain extends T.Term {\n//     constructor(term, param, next) {\n//         super(\"C\", term, next);\n//         this.param = param;\n//     }\n//     getEdgeData(i) { return i ? {edgename: this.param} : {edgename: null, identify:true}; }\n//     getData() { return {color: T.COLORS.gray, shape: \"rhomboid\", name: null}; }\n// }\n\n// export function app(f, arg)   { return new App2(f, arg); }\n// export function pterm(...args)   { return new PTerm(...args); }\n// export function cut(param, arg)   { return new PTerm(param, \"cut\", arg); }\n// export function diff(param, arg)   { return new PTerm(param, \"diff\", arg); }\n// export function chop(param, arg)   { return new PTerm(param, \"chop\", arg); }\n// export function run(param, arg)   { return new PTerm(param, \"run\", arg); }\n// export function chain(term, param, next)   { return new Chain(term, param, next); }\n// export function lamb(arg)   { return new Lamb(arg); }\n\n// export const VAR = new Var();\n\n////////\n\nconst Flavor = Object.freeze({\n  CUT:    Symbol(\"CUT\"),\n  DIFF:   Symbol(\"DIFF\"),\n  CHOP:   Symbol(\"CHOP\")\n});\nclass Ind {\n  constructor(i=0, flavor=Flavor.ORD) {\n    this.i = i;\n    this.flavor = flavor;\n    this.str = i.toString();\n    switch (flavor) {\n      case Flavor.CUT:    this.str =  \"(\"+this.str+\")-\";  break;\n      case Flavor.DIFF:   this.str =  \"+\"+this.str+\"+\";   break;\n      case Flavor.CHOP:   this.str = \"-(\"+this.str+\")\";   break;\n    }\n  }\n  toString() { return this.str; }\n}\nfunction icut(i)  { return new Ind(i, Flavor.CUT); }\nfunction idiff(i) { return new Ind(i, Flavor.DIFF); }\nfunction ichop(i) { return new Ind(i, Flavor.CHOP); }\nfunction iscut(i)  { return i.flavor == Flavor.CUT; }\nfunction isdiff(i) { return i.flavor == Flavor.DIFF; }\nfunction ischop(i) { return i.flavor == Flavor.CHOP; }\n\nexport const zero = idiff(0);\n\nfunction add(i, j) {\n  switch (i.flavor) {\n    case Flavor.CUT: \n      switch (j.flavor) {\n        case Flavor.CUT:  return icut(j.i + i.i);\n        case Flavor.DIFF: \n          if (i.i > j.i)  return icut(i.i - j.i);\n          if (i.i < j.i)  return idiff(j.i - i.i);\n          return zero;\n        case Flavor.CHOP: break;\n      }\n    case Flavor.DIFF:\n      switch (j.flavor) {\n        case Flavor.CUT:  break;\n        case Flavor.DIFF: break;\n        case Flavor.CHOP: \n          if (i.i > j.i)  return idiff(i.i - j.i);\n          if (i.i < j.i)  return ichop(j.i - i.i);\n          return zero;\n      }\n    case Flavor.CHOP:\n      switch (j.flavor) {\n        case Flavor.CUT:  break;\n        case Flavor.DIFF: break;\n        case Flavor.CHOP: return ichop(i.i + j.i);\n      }\n  }\n  throw `can't add: ${i} + ${j}`;\n}\n\n////////\n\nclass Shift extends T.Term {\n  constructor(ind, val) {\n    super(\"shift\", val);\n    this.ind = ind;\n    this.val = val;\n  }\n  getData() { return {color: T.COLORS.red, shape: \"diamond\", name: null}; }\n  getEdgeData(i) { return {edgename: this.ind}; }\n  toString() { return `(${this.ind} ${this.val})`; }\n  // hash() { return T.make_str(\"shift\", this.ind, this.val.hash0()); }\n  hash() { return T.make_uni(this.con, ...this.args)+this.ind; }\n  copy(val) { return new Shift(this.ind, val); }\n}\n\nclass Clos extends T.Term {\n  constructor(f, i, arg, j=0) {\n    super(\"clos\", f, arg);\n    this.f = f;\n    this.arg = arg;\n    this.inds = [idiff(i), idiff(j)];\n    console.log(this.con);\n    console.log(this.args);\n  }\n  getData() { return {color: T.COLORS.blue, shape: \"triangle\", name: null}; }\n  getEdgeData(i) { return {edgename: this.inds[i]}; }\n  hash() { return T.make_uni(this.con, ...this.args)+this.inds; }\n  copy(f, arg) { return new Clos(f, this.inds[0].i, arg, this.inds[1].i); }\n}\n\nclass Link extends T.Term {\n  constructor(term, ind, next) {\n    super(\"link\", term, next);\n    this.ind = idiff(ind);\n  }\n  getEdgeData(i) { return i ? {edgename: this.ind} : {edgename: null, identify:true}; }\n  getData() { return {color: T.COLORS.gray, shape: \"rhomboid\", name: null}; }\n  hash() { return T.make_str(\"link\", this.ind, this.next.hash0()); }\n  copy(term, next) { return new Link(term, this.ind.i, next); }\n}\nclass Var extends T.Term {\n  constructor() { super(\"var\"); }\n  getData() { return {color: T.COLORS.blue, shape: \"vee\", name: null}; }\n  // hash() { return \"(var)\"; }\n  copy() { return this; }\n  toString() { return \"v\"; }\n}\n\nexport const VAR = new Var();\n\nexport function shift(i, s)             { return new Shift(i, s); }\nexport function cut(i, s)               { return shift(icut(i),  s); }\nexport function diff(i, s)              { return shift(idiff(i), s); }\nexport function chop(i, s)              { return shift(ichop(i), s); }\nexport function zord(s)                 { return diff(zero, s); }\nexport function clos(f, i, arg, j=0)    { return new Clos(f, i, arg, j)}\nexport function app(f, arg)             { return cut(1, clos(f, 1, arg)); }\nexport function v(i)                    { return chop(i, VAR); }\nexport function link(term, i, next)     { return new Link(term, i, next); }\nexport function chain(...args) {\n  return args.length == 1 ? args[0] : link(args[0], args[1], chain(args.slice(2)));\n} \n\nfunction siscut(s)  { return s instanceof Shift && iscut(s.ind); }\nfunction sisdiff(s) { return s instanceof Shift && isdiff(s.ind); }\nfunction sischop(s) { return s instanceof Shift && ischop(s.ind); }\n\n////////\n\nvar myRules = [];\nif (true) {\n  let v  = T._mv(\"v\" , T.prim(T.WILD));\n  let v1 = T._mv(\"v1\", T.prim(T.WILD));\n  let v2 = T._mv(\"v2\", T.prim(T.WILD));\n  let t1 = T._mv(\"t1\");\n  let t2 = T._mv(\"t2\");\n  let t3 = T._mv(\"t3\");\n\n  // const E_B = window.E_B = new T.Rule(\"E_B\",\n  //   [ T.prop(T.bstep(t1, v1)) ], \n  //   T.prop(T.eq(t1, v1)));  // a does lookup in mapping\n\n  // const E_ShiftMerge = window.E_ShiftMerge = new T.Rule(\"E_ShiftMerge\",\n  //   // [ T._mv(\"a\", zord(T._mv(\"b\", zord(t1)))) ], \n  //   [ zord(zord(t1)) ],\n  //   T.prop(T.bstep(t1, t1))\n  // );  \n  \n  // const E_Refl = window.E_Refl = new T.Rule(\"E_Refl\", [], T.prop(T.eq(t1, t1)));\n  const S_Refl = window.S_Refl = new T.Rule(\"S_Refl\", [], T.prop(T.steps(t1, t1)) );\n  const E_S = window.E_S = new T.Rule(\"E_S\", [T.prop(T.steps(t1, t2))], T.prop(T.eq(t1, t2)) );\n  const E_B = window.E_B = new T.Rule(\"E_B\", [T.prop(T.bstep(t1, t2))], T.prop(T.eq(t1, t2)) );\n\n  // myRules = T.arithRules.concat([E_B, E_ShiftMerge]);\n  // myRules = T.arithRules.concat([E_Refl]);\n  myRules = T.arithRules.concat([S_Refl, E_S, E_B]);\n  window.RULES = myRules;\n}\n\nwindow.merge = function(n) {\n  let t1 = window.t(n);\n  let i = t1.ind;\n  let t2 = t1.val;\n  let j = t2.ind;\n  let t3 = t2.val;\n  let k = add(i, j);\n  let t4 = shift(k, t3);\n  let t5 = T._truth(T.eq(t1, t4));\n  window.echo(t5);\n  window.B.add(t5);\n}\n\n\n\n","import React from 'react';\nimport {ReactCytoscape, cytoscape} from 'react-cytoscape';\nimport klay from 'cytoscape-klay';\nimport * as R from 'ramda';\nimport {cmd} from './Util.js';\nimport * as T from './Term.js';\nimport * as O from './OrdDBI';\nimport cxtmenu from 'cytoscape-cxtmenu';\n\nimport data from './data2.json';\n// import trsData from './data.json';\n\ncytoscape.use(klay);\nvar klayy = window.klay = { name: 'klay', animate: true, klay: { direction: 'DOWN' } };\nvar dagre = window.dagre = { name: 'dagre', animate: true, nodeSep: 25, rankSep: 40 };\nvar tree = window.tree = { name: 'tree', animate: true };\nvar cose = window.cose = { name: 'cose', animate: true };\nvar none = window.none = { name: 'none' };\n\ncytoscape.use( cxtmenu );\n\n////\n\nconst style = [\n  {\n    selector: 'node',\n    style: {\n      'content': 'data(name)',\n      'text-valign': 'center',\n      'background-color': 'data(color)',\n      'border-color': ele => ele.data('border-color'),\n      'border-width': ele => ele.data('border-color') ? '2px' : '0',\n      'text-outline-color': 'data(color)',\n      'text-outline-width': '2px',\n      'color': '#FFF',\n      'font-size': 9,\n      'shape': 'data(shape)',\n      'text-wrap': 'wrap',\n      'text-margin-y': ele => ele.data('text-margin-y')\n    }\n  },\n\n  {\n    selector: 'edge',\n    style: {\n      // 'content': 'data(id)',\n      'content': 'data(edgename)',\n      'font-size': 8,\n      'curve-style': 'bezier',\n      'width': ele => ele.data('width') || 3,\n      'target-arrow-shape': ele => ele.data('identify') ? 'None' : 'triangle',\n      'line-color': '#9dbaea',\n      'target-arrow-color': '#9dbaea',\n      'source-endpoint': 'inside-to-node'\n    }\n  }\n];\n\nclass Cytoscape extends React.Component {\n  constructor(props) {\n    super(props);\n    this.send = props.send;\n    this.exec = props.exec;\n    this.focusTerm = props.focusTerm;\n    this.setupCyto = this.setupCyto.bind(this);\n    window.focusTerm = this.focusTerm;\n  }\n\n  setupCyto(cy) {\n    var cyto = this;\n    window.cy = cyto.cy = cy;\n    window.G = id => cy.$id(String(id));\n    // window.cyto = cyto;\n\n    // console.log(data);\n    cy.maxZoom(4);\n\n    ////\n\n    function treeLayout() {\n\n      function layout(node) {\n        var outgoers = node.outgoers().nodes().sort((e1, e2) => parseInt(e1)-parseInt(e2));\n        if (outgoers.empty()) { return [[0, 0]]; }\n\n        var children = R.zip(outgoers, outgoers.map(layout));\n        var [node0, shape] = children[0];\n        var width = 0;\n        for (var [cnode, cshape] of children.slice(1)) {\n          width = Math.max(...R.zipWith((L, R) => L[1]-R[0]+1, shape, cshape));\n          cnode.scratch().shift = width;\n          cshape = R.map(S => [S[0]+width, S[1]+width], cshape);\n\n          var newShape = R.zipWith((L, R) => [L[0], R[1]], shape, cshape);\n          if (shape.length > cshape.length) { newShape = newShape.concat(shape.slice(cshape.length)); }\n          else if (shape.length < cshape.length) { newShape = newShape.concat(cshape.slice(shape.length)); }\n          shape = newShape;\n        }\n\n        shape = [[0, 0]].concat(R.map(S => [S[0]-width/2, S[1]-width/2], shape));\n        children.map(c => c[0].scratch().shift -= width/2);\n        return shape;\n      }\n\n      function place(node, pos=null, x=0, y=0) {\n        x += node.scratch().shift*60*2/Math.sqrt(3);\n        y += 60;\n        pos[node.id()] = {x, y};\n        node.outgoers().nodes().map(n => place(n, pos, x, y));\n      }\n\n      var positions = {};\n      if (cy.nodes().nonempty()) {\n        cy.nodes().map(function(node) { node.scratch().shift = 0 });\n        layout(cy.nodes().roots());\n        place(cy.nodes().roots(), positions);\n      }\n\n      // console.log(positions);\n      cy.layout({ name: 'preset', animate: true, positions }).run();\n    }\n\n    var toLayout = window.toLayout =\n      (layout) => (typeof layout === 'object' ? layout : { name: layout, animate: true });\n    var lay = function(layout) {\n      var layout = layout ? toLayout(layout) : cyto.layout || dagre;\n      // console.log(layout.name);\n      if (layout.name === \"tree\") { return treeLayout(); }\n\n      var roots = cy.elements().roots();\n\n      var dists = cy.elements().bellmanFord({root: roots});\n      const colors = [\"#11479E\", \"#0A1128\", \"#586F7C\", \"#EAC435\", \"#E40066\"];\n      cy.elements().map(function(n) {\n        if (!n.data(\"forceStyle\")) {\n          n.data(\"color\", colors[dists.distanceTo(n) % colors.length]);\n          n.data(\"shape\", n.data(\"collapsed\") ? \"diamond\" :\n                          n.data(\"focused\") ? \"star\" : \"ellipse\");\n        }\n      })\n\n      var focused   = cy.filter(n => n.data(\"focused\"));\n      var collapsed = cy.filter(n => n.data(\"collapsed\"));\n      var underAllFocused =\n        R.reduce((acc,node) => acc.intersection(node.successors().union(node)),\n                 cy.elements(),     // all\n                 focused);\n      var blockedEdges = collapsed.outgoers().filter(e => e.isEdge());\n\n      // cy.elements().hide();\n      cy.elements().show();\n      cy.elements().filter(n => n.isNode()).hide();\n      cy.elements().not(blockedEdges).breadthFirstSearch({\n        root: roots,\n        directed: true,\n        visit: function(n, e) {\n          if (underAllFocused.has(n)) {\n            n.show();\n          }\n        }\n      });\n      blockedEdges.hide();\n\n      if (layout != none) {\n        cy.filter(n => n.visible()).layout(layout).run();\n      }\n    }\n    window.lay = window.l = cmd(lay);\n\n    function maybeLay() { if (cyto.layout) { lay(); } }\n    var setLay = window.setLay = function(layout) {\n      cyto.layout = toLayout(layout);\n      maybeLay();\n    };\n\n    function batch() {\n      if (cyto.batching) { return; }\n      cy.startBatch();\n      cyto.batching = true;\n      setTimeout(() => {\n        cy.endBatch();\n        cyto.batching = false;\n        maybeLay();\n      })\n    }\n    window.batch = batch;\n\n    ////\n\n    var NEXT_ID = 0;\n    function next() { return NEXT_ID++; }\n\n    var add = window.add = window.a = function(source, target) {\n      batch();\n      var id = next();\n      return cy.add({ data:\n        source ?\n          {id: id, name: id, source: source.id(), target: (target || add()).id()} :\n          {id: id, name: id}\n      });\n    }\n    var rem = window.rem = window.r = function() {\n      batch();\n      Array.from(arguments).map(x => cy.remove(x));\n    }\n\n    var spl = window.spl = window.s = function(edge) {\n      var mid = add();\n      add(edge.source(), mid);\n      add(mid, edge.target());\n      rem(edge);\n      return mid;\n    }\n    var dia = window.dia = window.d = function(edge) {\n      var mid = add();\n      add(edge.source(), mid);\n      add(mid, edge.target());\n      spl(edge);\n    }\n\n    ////\n\n    // var n0 = add(), n1 = add(), n2 = add(), n3 = add(), n4 = add(), n5 = add();//, n6 = add();\n    // add(n0, n1) && add(n0, n2) && add(n2, n3) && add(n2, n4) && add(n1, n5);// && add(n1, n6);\n\n    // setLay(dagre);\n    // var n0 = add(), n1 = add(), n2 = add(), n3 = add(), n4 = add(), n5 = add(), n6 = add();\n    // add(n0, n1) && add(n0, n2) && add(n0, n3) && add(n2, n4) && add(n3, n5) && add(n3, n6);\n    setLay(dagre);\n\n    // var NODES = {};\n    function addData(data) {\n    // var addData = window.addData = function(data) {\n      // if (data.name && data.name in NODES) { return NODES[data.name]; }\n      var n = add();\n      if (data.name) {\n        // NODES[data.name] = n;\n        n.data(\"name\", data.name);\n      }\n      if (data.collapsed) {\n        n.data(\"collapsed\", true);\n        n.data(\"reset-collapsed\", true);\n      }\n      if (data.info) {\n        n.data(\"info\", data.info);\n      }\n      R.map(c => add(n, addData(c)), data.children || []);\n      return n;\n    }\n\n    // addData(data);\n    // setLay(dagre);\n    // lay();\n\n    ////\n\n    const applyN = R.compose(R.reduceRight(R.compose, R.identity), R.repeat);\n    window.flash = applyN(x => x.animate({style:{opacity:0.5},duration:250})\n                                .animate({style:{opacity:1},duration:250}), 4);\n    window.grow = function() {\n      window.stop = false;\n      cy.$().remove(); add();\n      (function tick() {\n        if (!window.stop) {\n          add(cy.nodes().min(Math.random).ele);\n          setTimeout(tick, 1000);\n        }\n      })();\n    }\n\n    var hide = window.hide = function(node) {\n      batch();\n      node.data(\"collapsed\", true);\n    }\n    var show = window.show = function(node) {\n      batch();\n      node.data(\"collapsed\", false);\n    }\n    var focus = window.focus = function(node) {\n      batch();\n      // cy.elements().map(unfocus);\n      node.data(\"focused\", true);\n    }\n    var unfocus = window.unfocus = function(node) {\n      batch();\n      node.data(\"focused\", false);\n    }\n\n    var toggleShow = window.toggleShow = function(node) {\n      node.data(\"collapsed\") ? show(node) : hide(node);\n    }\n    var toggleFocus = window.toggleFocus = function(node) {\n      node.data(\"focused\") ? unfocus(node) : focus(node);\n    }\n    var collapse = window.collapse = function(node) {\n      node.union(node.successors()).map(hide);\n    }\n    var expand = window.expand = function(node) {\n      node.union(node.successors()).map(show);\n    }\n    var reset = function() {\n      cy.elements().map(n => n.data(\"reset-collapsed\") ? hide(n) : show(n));\n      cy.elements().map(unfocus);\n    }\n    window.reset = cmd(reset);\n\n    ////\n\n    var clear = function () {\n      cy.remove('*')\n    }\n    window.clear = cmd(clear);\n    var trs = function() {\n      clear();\n      setLay(none); // setLay(cose);\n      cy.userZoomingEnabled(false);\n      cy.userPanningEnabled(false);\n      document.getElementById('logo').style.display = \"none\";\n\n      // addData(trsData);\n      var B = window.B = new T.Builder(cy, next);\n      window.ireduce = (...args) => B.ireduce(...args);\n      window.iprove  = (...args) => B.iprove(...args);\n      window.reduce  = (...args) => B.reduce(...args);\n      window.prove   = (...args) => B.prove(...args);\n      window.areduce = (...args) => B.areduce(...args);\n      window.aprove  = (...args) => B.aprove(...args);\n      window.r       = (...args) => B.r(...args);\n      window.use     = (...args) => B.use(...args);\n      window.iequate = (...args) => B.iequate(...args);\n      window.isteps  = (...args) => B.isteps(...args);\n      // window.test    = (...args) => B.test(...args);\n      \n      let term = T.ifte(\n          T.ifte(T.prim(true), T.prim(false), T.prim(true)), \n          T.prim(3),      // T.plus(T.prim(3), T.mul(T.prim(3), T.prim(5))), \n          T.plus(T.prim(3), T.prim(5)));\n      // let term = T.ifte(T.prim(true), T.prim(10), T.prim(20));\n      // term = T.quote(term);\n      B.add(term);\n\n      // let t0 = O.app(O.chop(2, O.VAR), T.prim(true))\n      // let env = T.prim(null);\n      // env = O.link(T.prim('b'), 1, env);\n      // env = O.link(T.prim('a'), 1, env);\n      // env = O.link(t0, 1, env);\n      // let t1 = O.lamb(env);\n      // B.add(t1);\n\n      // B.add(T.mul(T.prim(4), T.type(\"foo\")));\n\n      // let t = O.app(O.v(1), T.prim(123));\n      // // let t = O.app(O.chop(1, T.prim(456)), T.prim(123));\n      // t = O.cut(1, t);\n      // B.add(t);\n\n      return \"TRS initiated. Enter [[;limegreen;]trshelp] for help and additional commands.\"\n    }\n    window.trs = cmd(trs);\n\n    trs();\n\n    ////\n\n    cy.on('tap', 'node, edge', function(evt) {\n      var e = evt.originalEvent;\n      // console.log(e);\n      if (e.altKey) {\n        if (e.shiftKey) {\n          cyto.exec(`r(G(${this.id()}))`);\n        } else if (e.ctrlKey || e.metaKey) {\n          cyto.exec(`ireduce(G(${this.id()}))`);\n        } else {\n          cyto.exec(`iprove(G(${this.id()}))`);\n        }\n      } else if (e.shiftKey) {\n        cyto.exec(`toggleFocus(G(${this.id()}))`);\n      } else if (e.ctrlKey || e.metaKey) {\n        cyto.exec(`toggleShow(G(${this.id()}))`);\n      } else {\n        cyto.send(`G(${this.id()})`);\n      }\n    });\n    cy.on('tapstart tapend cxttapstart cxttapend', window.focusTerm);\n\n    let commands = [ // reverse order\n      { content: 'rem',      select: ele => window.exec(`r(G(${ele.id()}))`),             fillColor: 'rgba(50, 0, 0, 0.75)', },\n      { content: 'focus',    select: ele => window.exec(`toggleFocus(G(${ele.id()}))`),   fillColor: 'rgba(50, 0, 0, 0.75)', },\n      { content: 'show',     select: ele => window.exec(`toggleShow(G(${ele.id()}))`),    fillColor: 'rgba(50, 0, 0, 0.75)', },\n      { content: '→*',       select: ele => window.exec(`isteps(G(${ele.id()}))`),        fillColor: 'rgba(0, 0, 50, 0.75)', },\n      { content: '=',        select: ele => window.exec(`iequate(G(${ele.id()}))`),       fillColor: 'rgba(0, 0, 50, 0.75)', },\n      { content: '⇓',        select: ele => window.exec(`ireduce(G(${ele.id()}))`),       fillColor: 'rgba(0, 0, 50, 0.75)', },\n      { content: 'a★',      select: ele => window.exec(`aprove(G(${ele.id()}))`),         fillColor: 'rgba(0, 50, 0, 0.75)', },\n      { content: 'i★',      select: ele => window.exec(`iprove(G(${ele.id()}))`),         fillColor: 'rgba(0, 50, 0, 0.75)', },\n      // { content: '★',             select: ele => window.exec(`prove(G(${ele.id()}))`) },\n    ]\n    // let L = commands.length;\n    // for (let [i, cmd] of commands.entries()) {\n    //   cmd.contentStyle = { transform: `rotate(${-Math.PI*((2*i+1)/L+(i<L/2 ? -0.5 : 0.5))}rad)` }\n    // }\n    cy.cxtmenu({commands});\n\n  }\n\n  render() {\n    return (\n      <ReactCytoscape containerID=\"cy\"\n        cyRef={this.setupCyto}\n        elements={{nodes:[]}}\n        // layout={tree}\n        style={style}\n        cytoscapeOptions={{wheelSensitivity: 0.1}}/>\n    );\n  }\n\n}\n\nexport default Cytoscape;\n","import React from 'react';\nimport './App.css';\nimport {cmd} from './Util.js';\nimport Terminal from './Terminal';\nimport Cytoscape from './Cytoscape.js';\nimport {Row, Col} from 'react-bootstrap';\nimport FontAwesome from 'react-fontawesome';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.send = this.send.bind(this);\n    this.setupTerm = this.setupTerm.bind(this);\n    // this.send(\"hi\");\n  }\n  send(val) {\n    window.terminal.insert(val);\n    window.terminal.focus();\n  }\n  exec(val) {\n    window.terminal.exec(val);\n    window.terminal.focus();\n  }\n  setupTerm(term) {\n    window.terminal = this.terminal = term;\n    window.echo = term.echo;\n    window.mecho = (x => { if (window.debug) { term.echo(x) } });\n    window.mlog = (x => { if (window.debug) { console.log(x) } });\n    window.dbg = cmd(() => window.debug = true);\n    window.send =       (x => this.send(x));\n    window.exec =       (x => this.exec(x));\n    window.focusTerm =  (x => this.focusTerm(x));\n    term.focus();\n    // Automatically run commands through terminal at start:\n    // this.exec(\"trs()\");\n    var searchParams = new URLSearchParams(window.location.search);\n    if (searchParams.has(\"exec\")) {\n      this.exec(searchParams.get(\"exec\"));\n    }\n  }\n  focusTerm() {\n    setTimeout(window.terminal.focus, 0)\n  }\n  render() {\n    return (\n      <div className=\"App\">\n        <Row>\n          <Col xs={6} sm={6} md={7} lg={7} style={{\"background\": \"linear-gradient(to bottom right, palegreen, aqua)\"}}>\n            <div className=\"App-body\">\n              <p id=\"logo\" className=\"App-logo\" onClick={()=>{this.send(\"secret\");this.focusTerm()}}>\n                <FontAwesome\n                  name='mouse-pointer'\n                  style={{ transform: 'scale(0.6, 1) rotate(112.5deg)' }} />\n                _\n              </p>\n              <Cytoscape send={this.send} exec={this.exec} focusTerm={this.focusTerm}/>\n            </div>\n          </Col>\n          <Col xs={6} sm={6} md={5} lg={5}>\n            <Terminal\n              onInit={this.setupTerm}\n              greetings={window.greetings}\n              prompt=\"=> \" />\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n}\n\nwindow.secret = cmd(function() {\n  var win = window.open(\"https://youtu.be/I0JobHULJiE\", '_blank');\n  win.focus();\n})\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}